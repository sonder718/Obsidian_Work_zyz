- [[图神经网络的计算过程]]
- [图神经网络-图注意力(GAT)详解及代码实现(一)_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1wP411T7dr/?spm_id_from=333.788&vd_source=a035df14d498cc5a51f3299bc26b3e65)
- **定义**GATLayer
	- in_features是N维节点信息,==不含边信息==
	- ![](attachments/Pasted%20image%2020230109120014.png)
- GATLayer的**输入**
	- N维节点信息
		- 6个节点×10维
	- 邻接矩阵信息
		- 6×6
	- ![](attachments/%E5%9B%BE%E6%B3%A8%E6%84%8F%E5%8A%9B%E7%BD%91%E7%BB%9CGAT%202023-01-09%2011.55.48.excalidraw.svg)%%[🖋 Edit in Excalidraw](attachments/%E5%9B%BE%E6%B3%A8%E6%84%8F%E5%8A%9B%E7%BD%91%E7%BB%9CGAT%202023-01-09%2011.55.48.excalidraw.md), and the [dark exported image](attachments/%E5%9B%BE%E6%B3%A8%E6%84%8F%E5%8A%9B%E7%BD%91%E7%BB%9CGAT%202023-01-09%2011.55.48.excalidraw.dark.svg)%%
- GATLayer的**向前推理**
	- 根据可训练参数W生成图注意力相关系数
	- 根据邻接矩阵 将$a_{ij}$的注意力系数保留或置为0,通过Softmax得到归一化的注意力权重矩阵attention
	- N×N的attention矩阵 乘 N×Out的节点信息矩阵
	- ![](attachments/Pasted%20image%2020230109120111.png)
		- ![](attachments/Pasted%20image%2020230109120014.png)
- GATLayer的**输出**
	- 6个节点通过注意力权重进行更新后的结果
	- 6个节点×5维
	- ![](attachments/Pasted%20image%2020230109115700.png)
- 利用 多头注意力网络进行节点分类的实例
	- 多头注意力机制层输出 通过注意力权重进行更新后 6个节点×5维
	- 单注意力机制层的outdim=类别,更新得6个节点×l类
	- softmax归一化得到概率
	- ![](attachments/Pasted%20image%2020230110170515.png)
# C语言程序的内存分段

## 正文段(代码与赋值段)
- 二进制代码与常量
	- `"string"`
- **全局赋值变量**
## 数据堆段
- 动态分配的存储区
	- `malloc()/new`分配的

## 数据栈段
- 临时使用的变量
- 未赋值的变量
- 函数调用实参传递值

# 应用程序的组成
## 组成
- 一个可执行二进制程序（在 linux 下为一个进程单元），在存储时（**没有加载到内存运行**），至少拥有三个部分，分别是**代码段(text)、数据段(data)、和BSS 段。**
- 当应用程序运行时（**运行态**），此时需要另外两个域：堆和栈。正在运行的程序：**代码段 + 数据段 + BSS 段 + 堆 + 栈**。
- ![](attachments/C%E8%AF%AD%E8%A8%80%E4%BB%A3%E7%A0%81%E4%B8%8E%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%202022-10-07%2016.24.06.excalidraw.svg)
%%[🖋 Edit in Excalidraw](attachments/C%E8%AF%AD%E8%A8%80%E4%BB%A3%E7%A0%81%E4%B8%8E%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%202022-10-07%2016.24.06.excalidraw.md)%%
## 内存管理
- **动态分配**
	- 在运行时执行动态分配。需要程序员显示管理，通过 malloc 申请，并且需要手动 free 掉，否则会造成内存泄漏
- **静态分配**
	- 在编译时就已经决定好了分配多少 Text+Data+Bss+Stack（静态分配）。
	- 静态分配的内存在进程结束后由**系统释放**（Text+Data）,Stack 上的数据则在退出函数后立即被销毁。

## 各段说明
### 代码段  .text
- 存放可执行程序的指令
- 存储态和运行态都有
- 静态
### 数据段  .data
- 存放已初始化（**非零初始化的全局变量和静态局部变量**）的数据，
- 存储态和运行态都有
### bss段  .bss
- 存放未初始化（**未初始化或者0初始化的全局变量和静态局部变量**）的数据，
- 存储态和运行态都有
### 堆  heap
- 动态分配内存，需要通过malloc手动申请，free手动释放，适合大块内存。
- 堆是先进先出（FIFO）数据结构。堆的地址空间是**向上增加**，即当堆上保存的数据越多，堆的地址越高。动态内存分配
- 容易造成内存泄漏和内存碎片。
- 运行态才有。
### 栈  stack
- **存放函数局部变量和参数以及返回值**，函数返回后，由操作系统**立即回收**。栈空间不大，使用不当容易栈溢出。
- 栈的另外一个重要特征是，它的地址空间 **向下减少**，即当栈上保存的数据越多，栈的地址越低。静态内存分配
- 运行态才有
- 静态
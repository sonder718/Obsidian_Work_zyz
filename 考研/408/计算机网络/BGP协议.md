# BGP协议
## 什么是BGP协议
- **边界网关协议**(Border Gateway Protocol, BGP)是不同自治系统的路由器之间交换路由信息的协议,是一种外部网关协议。
- BGP采用的是==路径向量路由选择协议==,它与距离向量协议和链路状态协议有很大的区别。
- BGP是==应用层协议==,它是基于==TCP==的。 #注意 #z408 
	- 不同自治系统之间网络复杂,需要可靠传输

	
## 为什么需要BGP协议
- 边界网关协议常用于互联网的**网关之间**。内部网关协议主要设法使数据报在**一个AS中**尽可能有效地从源站传送到目的站。
- 在一个AS内部不需要考虑其他方面的策略。然而BGP使用的环境却不同,主要原因如下:
	- 1)因特网的==规模太大==,使得自治系统之间路由选择非常困难。
	- 2)对于自治系统之间的路由选择,要==寻找最佳路由是很不现实==的。 #注意
	- 3)自治系统之间的路由选择必须考虑有关策略。边界网关协议(BGP)只能力求寻找一条**能够到达目的网络且比较好的路由**(不能兜圈子),而并非寻找一条最佳路由。

## BGP 的工作原理
- 每个自治系统的管理员要选择==至少一个==路由器(可以有多个)作为该自治系统的“**BGP发言人**”。
- 一个BGP发言人与其他自治系统中的BGP发言人要交换路由信息, 就要先建立==TCP连接==
	- (可见BGP报文是通过TCP传送的,也就是说BGP报文是TCP报文的数据部分
- 然后在此连接上交换BGP报文以建立BGP会话,再**利用BGP会话交换路由信息**。
- 当所有BGP发言人都相互交换**网络可达性的信息**后,各BGP发言人就可找出到达各个自治系统的较好路由。
	- 每个BGP发言人除必须运行BGP外,还**必须运行该AS所用的内部网关协议**,如OSPF或RIP. 
	- BGP所交换的**网络可达性信息**就是要到达某个网络(用网络前缀表示)所==要经过的一系列AS==。  #注意
	- 图4.12给出了一个BGP发言人交换路径向量的例子。
		- ![](attachments/Pasted%20image%2020221012192840.png)
## BGP的特点
- 1) BGP交换路由信息的结点数量级是自治系统的数量级,要比这些自治系统中的网络数少很多。
- 2)每个自治系统中BGP发言人(或边界路由器)的数目是很少的。这样就使得自治系统之间的路由选择不致过分复杂。
- 3) BGP支持CIDR,因此BGP的路由表也就应当包括目的**网络前缀**、**下一跳路由器**,以及到达该目的网络所要经过的各个==自治系统序列==。
- 4)在BGP刚运行时, BGP的邻站交换整个BGP路由表,但以后只需在**发生变化时更新有变化的部分**。这样做对节省网络带宽和减少路由器的处理开销都有好处。
<!--SR:!2022-10-17,4,270-->

## BGP-4使用的报文
![](attachments/Pasted%20image%2020221012193241.png)
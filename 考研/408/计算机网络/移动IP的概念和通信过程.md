# 什么是移动IP
- 支持移动性的因特网体系结构与协议共称为**移动 IP**
- 它是为了满足移动结点(计算机、服务器、网段等)在==移动中保持其连接性==而设计的。
	- 更确切地说,移动 IP 技术是指移动结点以固定的网络 IP 地址实现==跨越不同网段的漫游功能==,并保证基于网络 IP 的**网络权限在漫游过程中不发生任何改变**。
- 移动 IP 的**目标**
	- 把分组自动地投递给**移动结点**。
		- 一个移动结点是把其连接点从一个网络或子网改变到另一个网络或子网的主机。
	- 使用移动 IP,一个移动结点可以在==不改变其 IP 地址==的情况下==改变其驻留位置==。 #注意
# 移动 IP 定义的三种功能实体
- 基于 IPv4 的移动 IP 定义三种**功能实体**
	- **移动结点**
		- 具有永久 IP 地址的移动结点
		- 是指一个**主机或路由器**，当它在切换链路时可以不改变IP地址而仍能保持正在进行的通信。
	- **移动代理**
		- **归属代理**(也称本地代理)
			- **归属网络**
				- 在一个网络环境中,一个移动结点的永久“居所”被称为归属网络
			- **归属代理**
				- 在归属网络中代表移动结点执行移动管理功能的实体称为归属代理(本地代理)
					- 是指一个连接到**移动节点本地网络**的主机或路由器
				- 它根据移动用户的转交地址,采用==隧道技术==转交移动结点的数据包。
		- **外埠代理**(也称外部代理)。
			- 在外部网络中帮助移动结点完成移动管理功能的实体称为外部代理。
				- 指移动节点**当前的所在的**外地网络上的一个主机或路由器，它能够把由本地代理送来的数据包转发给移动节点。
# 移动IP的辨析
- 移动 IP 和移动自组网络并不相同
	- **移动 IP** 技术使漫游的主机可以用多种方式连接到因特网,移动 IP 的核心网络功能仍然是==基于固定互联网中一直使用的各种路由选择协议==
	- **移动自组网络**是将移动性扩展到无线领域中的==自治系统==,它具有自己独特的路由选择协议,并且可以==不和因特网相连==。
- 移动 IP 与动态 IP 是两个完全不同的概念
	- **动态 IP** 指的是局域网中的计算机可以通过网络中的 **DHCP** 服务器动态地获得一个IP 地址,而不需要用户在计算机的网络设置中指定 IP 地址
# 移动IP的通信过程
## 移动IP为移动主机设置的两个IP地址
- **主地址**和辅地址(**转交地址**)。
- 移动主机在本地网时,使用的是主地址。
- 当移动到另一个网络时,需要获得一个临时的辅地址,但此时主地址仍然不变。
- 从外网移回本地网时,**辅地址改变或撤销**,而主地址仍然保持不变
## 移动IP技术的基本通信流程
- 1)移动结点在**本地网**时
	- 按传统的TCP/IP方式进行通信(在本地网中有固有的地址)。
- 2)移动结点**漫游到一个外地网络**时
	- 仍然使用==固定的IP地址==进行通信。
	- 为了能够收到通信对端发给它的IP分组,移动结点需要向**本地代理**注册当前的位置地址,这个位置地址就是**转交地址**(它可以是外部代理的地址或动态配置的一个地址)。
- 3)**本地代理**接收来自==转交地址==的注册后
	- 构建一条通向转交地址的==隧道==,将截获的**发给移动结点的IP分组**通过**隧道**送到转交地址处。
		- 一台主机移动到了另一个LAN中,如果一个分组到达了它原来所在的LAN中,那么分组会被转发给==移动IP的本地代理==
- 4)在**转交地址**处**解除隧道封装**,恢复原始的IP分组,最后送到移动结点,这样移动结点在外网就能够收到这些发送给它的IP分组。
- 5)移动结点在外网通过外网的路由器或==外部代理==向通信对端发送IP数据包。
- 6)移动结点来到另一个外网时,只需向本地代理更新注册的转交地址,就可继续通信。
- 7)移动结点回到本地网时,移动结点向本地代理注销转交地址,这时移动结点又将使用传统的TCP/IP方式进行通信。
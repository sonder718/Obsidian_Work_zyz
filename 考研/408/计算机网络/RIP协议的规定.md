## RIP协议的规定

- **什么是好的路由**
	- RIP 认为好的路由就是它通过的路由器的数目少，即优先选择跳数少的路径。
- **为什么RIP只适用于小型互联网** #注意
	- RIP 允许一条路径最多只能包含==15==个路由器（即最多允许15跳)。因此距离==等于==16时，它表示==网络不可达==。 #注意
	- 距离向量路由可能会出现**环路**的情况，规定路径上的最高跳数的目的是为了==防止数据报不断循环在环路==上，减少网络拥塞的可能性。 #注意
		- **产生过程**
			- #注意 ==满收敛==是导致环路的**根本原因**
			- 产生环路的过程：
			- ![](attachments/Pasted%20image%2020221012202407.png)
			-  首先假设10.4.0.0网段Down掉，那么C路由器会在路由表中去掉10.4.0.0网段的路由信息，此时没毛病
			-  当下一个更新周期来到时，B会向C更新自己的路由表，C一看B的路由表中有10.4.0.0网段的路由且metric = 1自己没有，所以会在自己的路由表中加入一跳路由：  
			    目标网段：10.4.0.0  
			    矢量： S0 （**从B学习到的所以方向从S0口出**）  
			    距离： 2 （C路由表中为1所以此处应 + 1）
			- ![](attachments/Pasted%20image%2020221012202542.png)
			-  此时便形成路由环路，没有防环机制的话，**10.4.0.0这条路由会被一直在网络中的路由器学习更新**，每学一次metric值便增加1，如此往复直到达到无穷大，耗尽路由器资源网络瘫痪。
			- ****
		- **解决方法**(RIP防环机制)：
			- 触发更新
				- 指当RIP路由表中的某些路由项的内容发生改变时，路由器应该立即**向它的所有邻居**发布响应消息，**并不是等待更新定时器所规定的下一个响应消息的发送时刻。** #注意
				- 在实际的应用中，通常会在RIP路由器上配置触发更新功能，该功能不仅可以减低路由环路的产生，还可以加快路由收敛的速度，然后在水平分割和毒性逆转中选择一个进行配置。
			- 水平分割
				- 如果一个路由器的RIP路由表中目的地/掩码为(z/y)的路由信息时通过该路由器的Interface-x接口学习而来的
				- 则该路由器在通过Interface-x接口向外发送响应消息时，响应消息是**一定不能包含**该(z/y)这个路由项的信息的
			- 毒性逆转
				- 如果如果一个路由器的RIP路由表中目的地/掩码为(z/y)的路由信息时通过该路由器的Interface-x接口学习而来的
				- 则该路由器在通过Interface-x接口向外发送响应消息时，响应消息是**需要包含**z/y这个路由项的，但是这个路由项的**Cost总要设置为16，即不可达**。
- **怎么更新信息**
	- RIP 默认在任意两个使用RIP 的路由器之间每30秒广播一次RIP路由更新信息，以便自动建立并维护路由表（(动态维护)。
- **子网掩码必须相同** #疑问 #注意
	- 在RIP中不支持子网掩码的RIP广播，所以RIP中每个网络的子网掩码必须相同。但在新的RIP2中,支持变长子网掩码和CIDR。
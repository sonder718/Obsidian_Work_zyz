## 802.11局域网的MAC帧
- ![](attachments/%E6%97%A0%E7%BA%BF%E5%B1%80%E5%9F%9F%E7%BD%91%202022-10-09%2015.39.36.excalidraw.svg)
%%[🖋 Edit in Excalidraw](attachments/%E6%97%A0%E7%BA%BF%E5%B1%80%E5%9F%9F%E7%BD%91%202022-10-09%2015.39.36.excalidraw.md)%%
- 802.11帧的MAC 首部中最重要的是**4个地址字段**，上述地址都是**MAC硬件地址**。
	- 这里仅讨论前三种地址(地址4用于**自组网络**)。
	- 这三个地址的内容取决于帧控制字段中的“**去往AP**”和“**来自AP**”这两个字段的数值。
	- #z408 从AP来,地址3是源地址.去往AP,地址3是目的地址,地址1是**点对点接收地址**,地址2是**点对点发送地址**![](attachments/Pasted%20image%2020221009154331.png)
- 🐱**四个地址字段怎么协同工作** #注意 #z408 
	- 地址1是**直接接收**数据帧的结点地址，地址2是**实际发送数据帧**的结点地址。 #注意
	- 1）现假定在一个基本服务集中的**站A**向**站B**发送数据帧。
		- 在**站A**发往**接入点AP**的数据帧的帧控制字段中，“去往AP=1”而“来自AP=0";
		- 地址1是**AP**的MAC地址，地址2是**A**的MAC地址，地址3是**B**的MAC地址。
			- A🥇->AP->B
		- #注意 “接收地址”与“目的地址”并不等同。
	- 2)**AP**接收到数据帧后，转发给站**B**
		- 此时在数据帧的帧控制字段中，“去往AP=0”而“来自AP=1”;
		- 地址1是**B**的MAC地址，地址2是**AP**的MAC地址，地址3是**A**的MAC地址。
			-  A->AP🥇->B
		- 请注意,“发送地址”与“源地址”也不等同。
	- 3)两个**AP**通过有线连接到路由器,现在**路由器**要向站**A**发送数据。
		- 路由器是网络层设备,它**看不见链路层的接入点AP**,只认识站A的IP地址。
		- 而AP是链路层设备,它**只认识MAC地址**,并不认识IP地址。
		- 1）路由器从**IP数据报获知A的IP地址**，并使用ARP获取**站A的MAC地址**。获取站A的MAC地址后，**路由器接口R1**将该**IP数据报封装成802.3帧**(802.3帧只有两个地址),该帧的源地址字段是**R1的MAC地址**，目的地址字段是**A的MAC地址**
			- R1->A
		- 2）**AP**收到该802.3帧后，将该802.3帧**转换为802.11帧**，在帧控制字段中，“去往AP=0”而“来自AP= 1";地址1是A的MAC地址，地址2是AP的MAC地址，地址3**是R1的MAC地址。** 这样，A可以确定（<mark style="background: #FF5582A6;">从地址3</mark>）将数据报发送到子网中的路由器接口的MAC地址。
			- 由此可见,==地址3在BSS和有线局域网互联中起着关键作用==,它允许AP在构建以太网帧时能够确定**目的MAC地址**。 #注意 #z408 
			- 反向
			- ![](attachments/Pasted%20image%2020221009155915.png)
		- ![](attachments/%E6%97%A0%E7%BA%BF%E5%B1%80%E5%9F%9F%E7%BD%91%202022-10-09%2015.53.29.excalidraw.svg)
%%[🖋 Edit in Excalidraw](attachments/%E6%97%A0%E7%BA%BF%E5%B1%80%E5%9F%9F%E7%BD%91%202022-10-09%2015.53.29.excalidraw.md)%%
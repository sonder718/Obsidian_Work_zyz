# Tips
### 为什么要分片
- 一个==链路层==数据报能承载的最大数据量称为最大传送单元(MTU)。因为**IP数据报被封装在链路层数据报中，因此链路层的MTU严格地限制着IP数据报的长度**，而且在IP数据报的源与目的地路径上的各段链路可能使用不同的链路层协议，有不同的MTU。 #z408 
	- ![](attachments/Pasted%20image%2020221012205015.png)
- 例如，以太网的MTU为1500B，而许多广域网的MTU不超过576B。当IP数据报的总长度大于链路MTU时，就需要将IP数据报中的数据分装在两个或多个较小的IP数据报中，这些较小的数据报称为片。

### IP分片的传输过程
- **分片**可能发生在发送端，也可能发送在==中转路由器==上，而且可能在传输过程中被==多次分片==,在==目的主机==才实现**重组** #注意
	- **大IP分组**向较小MTU链路转发时， 可以被“分片” 
		- ![](attachments/Pasted%20image%2020221014114949.png)
### IP分片的示例
- 一个长4000B的IP数据报(**首部20B**,数据部分3980B)到达一个路由器,需要转发到一条MTU为1500B的链路上。
- 这意味着原始数据报中的==3980B数据==必须被分配到3个独立的片中(每片也是一个IP数据报)。
- ![](attachments/IP%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%88%86%E7%89%87-%E9%93%BE%E8%B7%AF%E5%B1%82MTU%E7%9A%84%E9%99%90%E5%88%B6%202022-10-12%2020.52.16.excalidraw.svg)
	- #注意 3个分片是==同一个==标识号777
	- MF= 1表示后面还有分片
	- **偏移值**的单位是==8B==,所以除最后一个片外,其他所有片中的**有效数据载荷**都是==8的倍数。== #注意 #z408 
		- 🐱分组最大字节数:1500 
%%[🖋 Edit in Excalidraw](attachments/IP%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%88%86%E7%89%87-%E9%93%BE%E8%B7%AF%E5%B1%82MTU%E7%9A%84%E9%99%90%E5%88%B6%202022-10-12%2020.52.16.excalidraw.md)%%